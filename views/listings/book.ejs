<% layout('/layouts/boilerplate') %>

<div class="container mt-5">
  <h2 class="text-center mb-4">Book Your Stay at <%= listing.title %></h2>

  <form action="/listings/<%= listing._id %>/book" method="POST" class="shadow p-5 rounded bg-light mt-5">

    <!-- Guest Name -->
    <div class="mb-3">
      <label for="guestName" class="form-label">Guest Name</label>
      <input type="text" name="guestName" id="guestName" class="form-control" placeholder="Enter your name" required>
    </div>

    <!-- Guest Age -->
    <div class="mb-3">
      <label for="guestAge" class="form-label">Guest Age</label>
      <input type="number" name="guestAge" id="guestAge" class="form-control" min="18" max="100" required>
    </div>

    <div class="mb-3">
      <div class="d-flex gap-3">
        <div class="flex-fill">
          <label for="checkIn" class="form-label">Check-in</label>
          <input type="date" name="checkIn" id="checkIn" class="form-control" required>
        </div>
        <div class="flex-fill">
          <label for="checkOut" class="form-label">Check-out</label>
          <input type="date" name="checkOut" id="checkOut" class="form-control" required>
        </div>
      </div>
    </div>

    <!-- Number of Guests -->
    <div class="mb-3">
      <label for="guests" class="form-label">Number of Guests</label>
      <input type="number" name="guests" id="guests" class="form-control" min="1" max="10" required>
    </div>

    <!-- Card Details -->
    <div class="mb-3">
      <label for="cardName" class="form-label">Name on Card</label>
      <input type="text" name="cardName" id="cardName" class="form-control" placeholder="Full name as on card" required>
    </div>

    <div class="mb-3">
      <label for="cardNumber" class="form-label">Card Number</label>
      <input type="text"
       name="cardNumber"
        id="cardNumber" 
        class="form-control"
         placeholder="Enter 12-digit card number"
          pattern="\d{12}" 
       maxlength="12"
       minlength="12"
       inputmode="numeric" 
       required>
    </div>

    <!-- Expiry + CVV (aligned perfectly) -->
    <div class="mb-3">
      <div class="d-flex gap-3">
        <div class="flex-fill">
          <label for="expiryMonth" class="form-label">Expiry Month</label>
          <select name="expiryMonth" id="expiryMonth" class="form-select" required>
            <option value="">MM</option>
            <% for(let i=1; i<=12; i++){ %>
              <option value="<%= i.toString().padStart(2, '0') %>"><%= i.toString().padStart(2, '0') %></option>
            <% } %>
          </select>
        </div>

        <div class="flex-fill">
          <label for="expiryYear" class="form-label">Expiry Year</label>
          <select name="expiryYear" id="expiryYear" class="form-select" required>
            <option value="">YYYY</option>
            <% const year = new Date().getFullYear();
               for(let i=year; i<=year+10; i++){ %>
              <option value="<%= i %>"><%= i %></option>
            <% } %>
          </select>
        </div>

        <div class="flex-fill">
          <label for="cvv" class="form-label">CVV</label>
          <input type="password" name="cvv" id="cvv" class="form-control" maxlength="3" placeholder="123" required>
        </div>
      </div>
    </div>

    <!-- Submit -->
    <div class="text-center">
      <button type="submit" class="btn btn-primary px-5">Confirm Booking</button>
    </div>

  </form>
</div>
